# üß™ Meta-Learning System - Testing Guide

## Prerequisites
1. ‚úÖ Python Backend Running: `uvicorn app:app --reload` (Port 8000)
2. ‚úÖ Next.js Frontend Running: `npm run dev` (Port 3000)
3. ‚úÖ Supabase Tables Created (Run `supabase_schema.sql` in your Supabase SQL Editor)
4. ‚úÖ Environment Variables Set (`.env` with `SUPABASE_URL` and `SUPABASE_KEY`)

---

## üéØ Test Scenarios

### 1. **Test Rule-Based Strategy** (Safety & Policy Layer)

#### Test Case 1.1: Blocked Query (Safety Violation)
**Input:**
```
Predict my marks for the upcoming exam
```

**Expected Behavior:**
- **Selected Strategy:** Rule-Based
- **Answer:** "I cannot fulfill this request. My safety protocols prevent me from answering queries related to predictions of personal scores..."
- **Confidence:** 100%
- **Reason:** "Safety Rule Violation Blocked"

#### Test Case 1.2: FAQ Match
**Input:**
```
What is meta-learning?
```

**Expected Behavior:**
- **Selected Strategy:** Rule-Based or Retrieval
- **Answer:** Static definition from rules or local knowledge base

---

### 2. **Test Retrieval Strategy** (Local KB + Web)

#### Test Case 2.1: Local Knowledge Match
**Input:**
```
What is Python?
```

**Expected Behavior:**
- **Selected Strategy:** Retrieval
- **Answer:** "Python is a high-level, interpreted programming language..." (from `knowledge_base.json`)
- **Confidence:** ~30-80% (cosine similarity score)
- **Reason:** "Local Retrieval (Cosine Similarity: X.XX)"

#### Test Case 2.2: Local Knowledge Match (Physics)
**Input:**
```
Explain Newton's laws
```

**Expected Behavior:**
- **Selected Strategy:** Retrieval
- **Answer:** "Newton's First Law states that an object will remain at rest..."

#### Test Case 2.3: Web Fallback (Wikipedia)
**Input:**
```
Who is Albert Einstein?
```

**Expected Behavior:**
- **Selected Strategy:** Retrieval
- **Answer:** Summary from Wikipedia API
- **Reason:** "Web Retrieval (Wikipedia API)"

---

### 3. **Test Classical ML Strategy** (Intent Classification + Calculations)

#### Test Case 3.1: Simple Calculation
**Input:**
```
Calculate 25 * 4
```

**Expected Behavior:**
- **Selected Strategy:** Classical ML
- **Answer:** "The product is 100." or "100"
- **Confidence:** 95%
- **Reason:** "Numerical calculation detected"

#### Test Case 3.2: Complex Calculation
**Input:**
```
What is 150 divided by 6?
```

**Expected Behavior:**
- **Selected Strategy:** Classical ML
- **Answer:** "The quotient is 25."

#### Test Case 3.3: Definition Intent
**Input:**
```
Define supervised learning
```

**Expected Behavior:**
- **Selected Strategy:** Classical ML
- **Answer:** Intent-based response (template or actual definition)
- **Reason:** "ML Intent: definition"

---

### 4. **Test Transformer Strategy** (Deep Learning / Complex Queries)

#### Test Case 4.1: High Complexity Explanation
**Input:**
```
Explain the detailed implications of AI in healthcare vs finance
```

**Expected Behavior:**
- **Selected Strategy:** Transformer
- **Answer:** Coherent multi-sentence explanation generated by Flan-T5
- **Confidence:** 85%
- **Reason:** "Generated by Flan-T5 Transformer"

#### Test Case 4.2: Deep Reasoning
**Input:**
```
Why do neural networks require large amounts of data and how does this impact their generalization capability?
```

**Expected Behavior:**
- **Selected Strategy:** Transformer
- **Answer:** Detailed reasoning from the model

---

## üîÑ Test Meta-Learning Loop (Auto-Retraining)

### Test Case 5.1: Positive Feedback ‚Üí Auto-Retrain

**Steps:**
1. Ask: `Calculate 50 / 2`
   - System selects **Classical ML**
   - Returns: "The quotient is 25."

2. **Click "Helpful"** ‚úÖ

3. **Check Terminal Output:**
   You should see:
   ```
   ============================================================
   [META-LEARNING] üß† POSITIVE FEEDBACK RECEIVED!
   [META-LEARNING] üîÑ Triggering automatic model retraining...
   ============================================================
   [META-LEARNING] Fetched X recent experiences for training
   Model successfully retrained with X new examples.
   ============================================================
   [META-LEARNING] ‚úÖ Auto-learning complete!
   ============================================================
   ```

4. **Verify:**
   - Feedback recorded in Supabase `experiences` table
   - Strategy weights updated
   - ML model retrained

### Test Case 5.2: Negative Feedback ‚Üí No Retrain

**Steps:**
1. Ask any question
2. **Click "Not Helpful"** ‚ùå
3. **Check Terminal:** Should NOT see retraining logs
4. **Verify:** Weights updated, but model NOT retrained

---

## üß™ Manual Retrain Button Test

### Test Case 6.1: Trigger Manual Retrain

**Steps:**
1. Scroll to bottom of dashboard
2. Find **"System Maintenance (Meta-Learning Ops)"** card
3. Click **"Retrain ML Models (Use Feedback Data)"** button
4. **Check Terminal:** Should see retraining logs
5. **Alert:** Should show "ML Engine retraining completed successfully"

---

## üìä Test Statistics Endpoint

**Steps:**
1. Open: `http://localhost:8000/stats`
2. **Expected JSON Response:**
   ```json
   {
     "strategy_stats": {
       "Rule-Based": { "weight": 1.0, "success_rate": 0.5, "total_uses": 2 },
       "Retrieval": { ... },
       "Classical ML": { ... },
       "Transformer": { ... }
     },
     "total_queries": 10,
     "recent_experiences": [...]
   }
   ```

---

## üîç Debugging Checklist

### If queries fail:
- [x] Is Python backend running? Check `http://localhost:8000/health`
- [x] Is Next.js frontend running? Check `http://localhost:3000`
- [x] Are Supabase credentials correct? Check `.env` file
- [x] Are Supabase tables created? Check SQL Editor

### If retraining doesn't work:
- [x] Check terminal for `[META-LEARNING]` logs
- [x] Verify feedback is being stored in Supabase
- [x] Ensure at least 3 positive-feedback items exist
- [x] Check `data/ml_model.joblib` file is being updated (check timestamp)

### If Transformer gives weird answers:
- [x] Verify model loaded correctly (check startup logs)
- [x] Model should say: `Model loaded successfully on cpu!`
- [x] If errors, try reinstalling: `pip install transformers torch`

---

## ‚úÖ Expected Final State

After running all tests, your system should:
1. ‚úÖ Successfully route 4 different query types to 4 different strategies
2. ‚úÖ Automatically retrain on positive feedback (visible in terminal)
3. ‚úÖ Store all interactions in Supabase
4. ‚úÖ Update strategy weights based on feedback
5. ‚úÖ Display clear decision rationale in UI

---

## üöÄ Demo Script (For Presentation)

1. **Open Dashboard** ‚Üí `http://localhost:3000`
2. **Show Safety:** `Predict my marks` ‚Üí Blocked ‚ùå
3. **Show Retrieval:** `What is Python?` ‚Üí Local KB match ‚úÖ
4. **Show ML:** `Calculate 25 * 4` ‚Üí Calculation ‚úÖ
5. **Show Transformer:** `Explain AI in healthcare` ‚Üí Deep reasoning ‚úÖ
6. **Show Learning:** Click "Helpful" ‚Üí Watch terminal auto-retrain üß†
7. **Show Stats:** Navigate to `/stats` endpoint ‚Üí Show metrics üìä

---

**You now have a fully functional Meta-Learning AI System!** üéâ
